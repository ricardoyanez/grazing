--- zbrac.f.orig	2002-10-14 12:40:58.000000000 -0700
+++ zbrac.f	2022-11-08 11:24:07.369377441 -0800
@@ -1,4 +1,6 @@
       SUBROUTINE ZBRAC(FUNC,X1,X2,SUCCES)
+      IMPLICIT REAL*8(A-H,O-Z)
+      EXTERNAL FUNC
       PARAMETER (FACTOR=1.6,NTRY=50)
       LOGICAL SUCCES
       IF(X1.EQ.X2)PAUSE 'You have to guess an initial range'
@@ -6,8 +8,8 @@
       F2=FUNC(X2)
       SUCCES=.TRUE.
       DO 11 J=1,NTRY
-        IF(F1*F2.LT.0.)RETURN
-        IF(ABS(F1).LT.ABS(F2))THEN
+        IF(F1*F2.LT.0.D0)RETURN
+        IF(DABS(F1).LT.DABS(F2))THEN
           X1=X1+FACTOR*(X1-X2)
           F1=FUNC(X1)
         ELSE
